{% from 'elasticSend.j2' import elasticSend %}
# Send GLPI messages to elasticsearch
template(
  name="elasticSearchIndexGlpi"
  type="string"
  string="glpi-%$YEAR%.%$MONTH%.%$DAY%"
)
input(
  type="imfile"
  file="/var/log/glpi/bench_inventory.log"
  startmsg.regex="^.+[]]$"
  tag="glpi-bench-inventory"
  severity="info"
  facility="local0"
  ruleset="glpi"
)
input(
  type="imfile"
  file="/var/log/glpi/cron.log"
  startmsg.regex="^.+[]]$"
  tag="glpi-cron"
  severity="info"
  facility="local0"
  ruleset="glpi"
)
input(
  type="imfile"
  file="/var/log/glpi/event.log"
  startmsg.regex="^.+[]]$"
  tag="glpi-event"
  severity="notice"
  facility="local0"
  ruleset="glpi"
)
input(
  type="imfile"
  file="/var/log/glpi/php-errors.log"
  startmsg.regex="^[[]"
  tag="glpi-php-errors"
  severity="warning"
  facility="local0"
  ruleset="glpi"
)
input(
  type="imfile"
  file="/var/log/glpi/sql-errors.log"
  startmsg.regex="^[[]"
  tag="glpi-sql-errors"
  severity="err"
  facility="local0"
  ruleset="glpi"
)
ruleset(name="glpi") {
  {{ elasticSend(es, 'elasticSearchIndexGlpi') | indent(2) }}
}
